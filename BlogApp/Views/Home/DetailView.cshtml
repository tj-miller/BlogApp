@{
    ViewBag.Title = "Simple Blog Application";
}

<script src="jquery-3.4.1.min.js"></script>
<script type="text/javascript">
    function PostCommentFn() {
        $.ajax({
            type: "POST",
            url: '/Home/PostComment',
            data: "",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (msg) {
                $("#divResult").html("success");
            },
            error: function (xhr, status, error) {
                var err = eval("(" + xhr.responseText + ")");
                $("#divResult").html(err.Message);
            }

        })
    }
</script>

<div>
    <h1>Simple Blog Application</h1>
    <p class="lead">by Travis Miller</p>
</div>

<div class="row">

    @{
        <h3 style="width:100%">@ViewBag.Blog.Title</h3>
        <small>@ViewBag.Blog.CreationDate</small>
        <p>@ViewBag.Blog.Content</p>
    }

    @{
        var commentValue = Request.Form["commentText"];
        int currBlogId = ViewBag.Blog.ID;
    }


    <h4>Comments</h4>

    @foreach (var comment in ViewBag.Blog.Comments)
    {
        <div class="jumbotron" style="width: 100%; padding: 0 1rem;">

            <small>@comment.CreationDate</small>
            <p>@comment.Content</p>

        </div>
    }

    <h4>Add Comment</h4>
    <div id="divResult"></div>
    <div style="width:100%;">
        <input id="commentText" type="text" style="width:100%; max-width:100%;" />
    </div>
    <div style="width:100%; display:flex; justify-content:space-between;">
        <button class="btn-primary" style="margin-top: 10px;" OnClientClick="return false;"
                onclick="PostCommentFn(); @("window.location.href='" + @Url.Action("DetailView", "Home", new { blogPostId = currBlogId },null) + "'");">
            Post Comment
        </button>
        <button class="btn-secondary" style="margin-top: 10px;" onclick="@("window.location.href='" + @Url.Action("Index", "Home") + "'");">Cancel</button>
    </div>
</div>
<!--Html.Action("PostComment", new { ViewBag.Blog.ID, commentValue}); -->