@{
    ViewBag.Title = "Simple Blog Application";
}

<script type="text/javascript">
    function PostCommentFn() {
        console.log('init ajax');
        $.ajax({
            type: "POST",
            url: '/Home/PostComment',
            data: {"blogID": $("#commentText").val(), "comment": @ViewBag.Blog.ID },
            success: function (msg) {
                $("#divResult").html("success");
                console.log(msg);
            },
            failure: function (msg) {
                $("#divResult").html("failure");
                console.log(msg);
            },
            error: function (msg) {
                $("#divResult").html("error");
                console.log(msg);
            }

        })
    }
</script>

<div>
    <h1>Simple Blog Application</h1>
    <p class="lead">by Travis Miller</p>
</div>

<div class="row">

    @{
        <h3 style="width:100%">@ViewBag.Blog.Title</h3>
        <small>@ViewBag.Blog.CreationDate</small>
        <p>@ViewBag.Blog.Content</p>
    }

    @{
        int currBlogId = ViewBag.Blog.ID;
    }


    <h4>Comments</h4>

    @foreach (var comment in ViewBag.Blog.Comments)
    {
        <div class="jumbotron" style="width: 100%; padding: 0 1rem;">

            <small>@comment.CreationDate</small>
            <p>@comment.Content</p>

        </div>
    }

    <h4>Add Comment</h4>
    <div id="divResult"></div>
    <div style="width:100%;">
        <input id="commentText" type="text" style="width:100%; max-width:100%;" />
    </div>
    <div style="width:100%; display:flex; justify-content:space-between;">
        <button class="btn-primary" style="margin-top: 10px;" OnClientClick="return false;"
                onclick="PostCommentFn(); ">
            Post Comment
        </button>
        <button class="btn-secondary" style="margin-top: 10px;" onclick="@("window.location.href='" + @Url.Action("Index", "Home") + "'");">Cancel</button>
    </div>
</div>
